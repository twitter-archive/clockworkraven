-# Copyright 2012 Twitter, Inc. and others.
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-#     http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.

%h1= @job.title || "Job Progress"

.progress.progress-striped{:class => ('active' unless @job.ended?)}
  .bar.bar-success#progress_bar_success{:style => "width: #{@job.success_percentage}%"}
  .bar.bar-danger#progress_bar_error{:style => "width: #{@job.error_percentage}%"}

.progress-text{:style => ('display: none' if @job.status_name == :new)}
  %span.completed= @job.completed
  \/
  %span.total= @job.total
  = surround '(', ')' do
    %span.error-count= @job.error_count
    failed

.queued{:style => ('display: none' unless @job.status_name == :new)}
  Queued

.buttons
  %button.btn.btn-danger{:type => 'button', :onclick => js_redirect(@job.back_url)}
    &laquo; Back

  = link_to retry_job_url(@job), :method => :post, :style => ('display: none' unless @job.parts_failed?), :class => 'btn btn-primary' do
    %i.icon-repeat.icon-white
    Retry

  %button.btn.btn-inverse{:type => 'button', :onclick => 'Jobs.killJob()', :disabled => ('disabled' if @job.ended?), :style => ('display: none' if @job.parts_failed?)}
    %i.icon-remove.icon-white
    Cancel

  %button.btn.btn-success{:type => 'button', :onclick => js_redirect(@job.complete_url), :disabled => ('disabled' unless @job.status_name == :done)}
    Continue &raquo;

.alert.alert-error{:style => ('display: none;' unless @job.error)}
  %h4.alert-heading An error occurred

  %pre.alert-content= @job.error